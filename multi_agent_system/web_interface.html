<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Agent Website Analysis Interface</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0;
            min-height: 600px;
        }

        .form-section {
            padding: 40px;
            background: #f8f9fa;
            border-right: 1px solid #e9ecef;
        }

        .results-section {
            padding: 40px;
            background: white;
            overflow-y: auto;
            max-height: 80vh;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
            font-size: 0.95em;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 1em;
            transition: all 0.3s ease;
            background: white;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 10px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            padding: 12px;
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .checkbox-item:hover {
            border-color: #667eea;
            background: #f8f9ff;
        }

        .checkbox-item input[type="checkbox"] {
            margin-right: 10px;
            transform: scale(1.2);
        }

        .checkbox-item.checked {
            border-color: #667eea;
            background: #f0f2ff;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 20px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .progress-container {
            display: none;
            margin: 20px 0;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s ease;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .progress-text {
            text-align: center;
            margin-top: 10px;
            color: #6c757d;
            font-size: 0.9em;
        }

        .results-container {
            display: none;
        }

        .result-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .result-section h3 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .result-content {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #e9ecef;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.9em;
            line-height: 1.5;
            max-height: 300px;
            overflow-y: auto;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #f5c6cb;
            margin: 20px 0;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #c3e6cb;
            margin: 20px 0;
        }

        .history-section {
            margin-top: 30px;
            padding-top: 30px;
            border-top: 2px solid #e9ecef;
        }

        .history-item {
            background: #f8f9fa;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #28a745;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .history-item:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }

        .history-url {
            font-weight: 600;
            color: #495057;
        }

        .history-time {
            font-size: 0.8em;
            color: #6c757d;
            margin-top: 5px;
        }

        .clear-history {
            background: #dc3545;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            margin-top: 10px;
        }

        .clear-history:hover {
            background: #c82333;
        }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-success { background: #28a745; }
        .status-error { background: #dc3545; }
        .status-loading { background: #ffc107; animation: pulse 1s infinite; }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .form-section {
                border-right: none;
                border-bottom: 1px solid #e9ecef;
            }
            
            .checkbox-group {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü§ñ Multi-Agent Website Analysis</h1>
            <p>–ê–Ω–∞–ª–∏–∑ –≤–µ–±-—Å–∞–π—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é –ò–ò –∞–≥–µ–Ω—Ç–æ–≤</p>
        </div>

        <div class="main-content">
            <div class="form-section">
                <form id="analysisForm">
                    <div class="form-group">
                        <label for="apiKey">API Key</label>
                        <input type="text" id="apiKey" placeholder="test-key-123 –∏–ª–∏ admin-key-456" required>
                    </div>

                    <div class="form-group">
                        <label for="url">URL —Å–∞–π—Ç–∞</label>
                        <input type="url" id="url" placeholder="https://example.com" required>
                    </div>

                    <div class="form-group">
                        <label>–ê–≥–µ–Ω—Ç—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞</label>
                        <div class="checkbox-group">
                            <div class="checkbox-item" onclick="toggleCheckbox('classifier')">
                                <input type="checkbox" id="classifier" checked>
                                <label for="classifier">–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä</label>
                            </div>
                            <div class="checkbox-item" onclick="toggleCheckbox('summary')">
                                <input type="checkbox" id="summary" checked>
                                <label for="summary">–†–µ–∑—é–º–µ</label>
                            </div>
                            <div class="checkbox-item" onclick="toggleCheckbox('ux')">
                                <input type="checkbox" id="ux" checked>
                                <label for="ux">UX –ê–Ω–∞–ª–∏–∑</label>
                            </div>
                            <div class="checkbox-item" onclick="toggleCheckbox('design')">
                                <input type="checkbox" id="design" checked>
                                <label for="design">–î–∏–∑–∞–π–Ω</label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="analysisDepth">–ì–ª—É–±–∏–Ω–∞ –∞–Ω–∞–ª–∏–∑–∞</label>
                        <select id="analysisDepth">
                            <option value="quick">–ë—ã—Å—Ç—Ä—ã–π (–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è + —Ä–µ–∑—é–º–µ)</option>
                            <option value="full" selected>–ü–æ–ª–Ω—ã–π (–≤—Å–µ –∞–≥–µ–Ω—Ç—ã)</option>
                            <option value="custom">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="outputFormat">–§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞</label>
                        <select id="outputFormat">
                            <option value="json" selected>JSON</option>
                            <option value="summary">–ö—Ä–∞—Ç–∫–∏–π —Ç–µ–∫—Å—Ç</option>
                            <option value="detailed">–ü–æ–¥—Ä–æ–±–Ω—ã–π</option>
                        </select>
                    </div>

                    <div class="progress-container" id="progressContainer">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                        <div class="progress-text" id="progressText">–ê–Ω–∞–ª–∏–∑ –∑–∞–ø—É—â–µ–Ω...</div>
                    </div>

                    <button type="submit" class="btn" id="analyzeBtn">
                        üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–Ω–∞–ª–∏–∑
                    </button>
                </form>
            </div>

            <div class="results-section">
                <div id="resultsContainer" class="results-container">
                    <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞</h2>
                    <div id="resultsContent"></div>
                </div>

                <div id="emptyState" style="text-align: center; padding: 60px 20px; color: #6c757d;">
                    <div style="font-size: 4em; margin-bottom: 20px;">üîç</div>
                    <h3>–ì–æ—Ç–æ–≤ –∫ –∞–Ω–∞–ª–∏–∑—É</h3>
                    <p>–í–≤–µ–¥–∏—Ç–µ URL –∏ –Ω–∞–∂–º–∏—Ç–µ "–ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–Ω–∞–ª–∏–∑"</p>
                </div>

                <div class="history-section">
                    <h3>–ò—Å—Ç–æ—Ä–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤</h3>
                    <div id="historyContainer"></div>
                    <button class="clear-history" onclick="clearHistory()">–û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let requestHistory = JSON.parse(localStorage.getItem('analysisHistory') || '[]');
        let currentRequest = null;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            loadHistory();
            setupFormHandlers();
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ñ–æ—Ä–º—ã
        function setupFormHandlers() {
            document.getElementById('analysisForm').addEventListener('submit', handleFormSubmit);
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ–∫–±–æ–∫—Å–æ–≤ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –≥–ª—É–±–∏–Ω—ã –∞–Ω–∞–ª–∏–∑–∞
            document.getElementById('analysisDepth').addEventListener('change', updateAgentCheckboxes);
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ–∫–±–æ–∫—Å–æ–≤ –∞–≥–µ–Ω—Ç–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≥–ª—É–±–∏–Ω—ã –∞–Ω–∞–ª–∏–∑–∞
        function updateAgentCheckboxes() {
            const depth = document.getElementById('analysisDepth').value;
            const checkboxes = ['classifier', 'summary', 'ux', 'design'];
            
            if (depth === 'quick') {
                // –ë—ã—Å—Ç—Ä—ã–π –∞–Ω–∞–ª–∏–∑ - —Ç–æ–ª—å–∫–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏ —Ä–µ–∑—é–º–µ
                document.getElementById('classifier').checked = true;
                document.getElementById('summary').checked = true;
                document.getElementById('ux').checked = false;
                document.getElementById('design').checked = false;
            } else if (depth === 'full') {
                // –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ - –≤—Å–µ –∞–≥–µ–Ω—Ç—ã
                checkboxes.forEach(id => document.getElementById(id).checked = true);
            }
            // –î–ª—è custom –æ—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –µ—Å—Ç—å
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —á–µ–∫–±–æ–∫—Å–æ–≤
        function toggleCheckbox(id) {
            const checkbox = document.getElementById(id);
            checkbox.checked = !checkbox.checked;
            updateCheckboxItem(id);
        }

        function updateCheckboxItem(id) {
            const item = document.querySelector(`[onclick="toggleCheckbox('${id}')"]`);
            const checkbox = document.getElementById(id);
            
            if (checkbox.checked) {
                item.classList.add('checked');
            } else {
                item.classList.remove('checked');
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —á–µ–∫–±–æ–∫—Å–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        ['classifier', 'summary', 'ux', 'design'].forEach(updateCheckboxItem);

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
        async function handleFormSubmit(e) {
            e.preventDefault();
            
            const formData = getFormData();
            if (!validateForm(formData)) return;
            
            await performAnalysis(formData);
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã
        function getFormData() {
            return {
                apiKey: document.getElementById('apiKey').value.trim(),
                url: document.getElementById('url').value.trim(),
                agents: {
                    classifier: document.getElementById('classifier').checked,
                    summary: document.getElementById('summary').checked,
                    ux: document.getElementById('ux').checked,
                    design: document.getElementById('design').checked
                },
                analysisDepth: document.getElementById('analysisDepth').value,
                outputFormat: document.getElementById('outputFormat').value
            };
        }

        // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã
        function validateForm(data) {
            if (!data.apiKey) {
                showError('–í–≤–µ–¥–∏—Ç–µ API –∫–ª—é—á');
                return false;
            }
            
            if (!data.url) {
                showError('–í–≤–µ–¥–∏—Ç–µ URL —Å–∞–π—Ç–∞');
                return false;
            }
            
            if (!data.url.startsWith('http://') && !data.url.startsWith('https://')) {
                showError('URL –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å http:// –∏–ª–∏ https://');
                return false;
            }
            
            const hasSelectedAgent = Object.values(data.agents).some(checked => checked);
            if (!hasSelectedAgent) {
                showError('–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞');
                return false;
            }
            
            return true;
        }

        // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∞
        async function performAnalysis(formData) {
            const startTime = Date.now();
            currentRequest = {
                id: Date.now(),
                url: formData.url,
                timestamp: startTime,
                status: 'loading'
            };
            
            showProgress();
            hideResults();
            
            try {
                const requestPayload = {
                    url: formData.url,
                    agents_config: {
                        classifier: formData.agents.classifier,
                        summary: formData.agents.summary,
                        ux_reviewer: formData.agents.ux,
                        design_advisor: formData.agents.design
                    },
                    analysis_depth: formData.analysisDepth,
                    output_format: formData.outputFormat,
                    use_cache: true
                };
                
                updateProgress(20, '–û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞...');
                
                const response = await fetch('/analyze', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-API-Key': formData.apiKey
                    },
                    body: JSON.stringify(requestPayload)
                });
                
                updateProgress(50, '–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞...');
                
                const result = await response.json();
                
                updateProgress(80, '–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤...');
                
                if (response.ok && result.success) {
                    currentRequest.status = 'success';
                    currentRequest.duration = Date.now() - startTime;
                    displayResults(result.data, result.metadata);
                    showSuccess(`–ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω –∑–∞ ${currentRequest.duration}ms`);
                } else {
                    currentRequest.status = 'error';
                    showError(result.error || '–û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞');
                }
                
                updateProgress(100, '–ó–∞–≤–µ—Ä—à–µ–Ω–æ');
                
            } catch (error) {
                currentRequest.status = 'error';
                showError(`–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${error.message}`);
                updateProgress(0, '–û—à–∏–±–∫–∞');
            } finally {
                // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
                addToHistory(currentRequest);
                hideProgress();
            }
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        function displayResults(data, metadata) {
            const container = document.getElementById('resultsContent');
            container.innerHTML = '';
            
            // –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
            const generalInfo = document.createElement('div');
            generalInfo.className = 'result-section';
            generalInfo.innerHTML = `
                <h3>üìä –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                <div class="result-content">
                    <strong>URL:</strong> ${data.url}<br>
                    <strong>–°—Ç–∞—Ç—É—Å:</strong> ${data.status}<br>
                    <strong>–¢–∏–ø –∞–Ω–∞–ª–∏–∑–∞:</strong> ${metadata.analysis_depth}<br>
                    <strong>–§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞:</strong> ${metadata.output_format}<br>
                    <strong>–í—Ä–µ–º—è –∞–Ω–∞–ª–∏–∑–∞:</strong> ${metadata.analysis_time.toFixed(2)}s<br>
                    <strong>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –∫—ç—à:</strong> ${metadata.cache_used ? '–î–∞' : '–ù–µ—Ç'}
                </div>
            `;
            container.appendChild(generalInfo);
            
            // –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è
            if (data.classification && data.classification.success) {
                const classification = document.createElement('div');
                classification.className = 'result-section';
                classification.innerHTML = `
                    <h3>üè∑Ô∏è –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è</h3>
                    <div class="result-content">
                        <strong>–¢–∏–ø —Å–∞–π—Ç–∞:</strong> ${data.classification.classification.type}<br>
                        <strong>–ò–Ω–¥—É—Å—Ç—Ä–∏—è:</strong> ${data.classification.classification.industry || '–ù–µ —É–∫–∞–∑–∞–Ω–∞'}<br>
                        <strong>–¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è:</strong> ${data.classification.classification.target_audience || '–ù–µ —É–∫–∞–∑–∞–Ω–∞'}<br>
                        <strong>–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å:</strong> ${(data.classification.classification.confidence * 100).toFixed(1)}%<br>
                        <strong>–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:</strong> ${data.classification.classification.reason}
                    </div>
                `;
                container.appendChild(classification);
            }
            
            // –†–µ–∑—é–º–µ
            if (data.summary && data.summary.success) {
                const summary = document.createElement('div');
                summary.className = 'result-section';
                summary.innerHTML = `
                    <h3>üìù –†–µ–∑—é–º–µ</h3>
                    <div class="result-content">
                        <strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–≤:</strong> ${data.summary.summary.word_count}<br>
                        <strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π:</strong> ${data.summary.summary.sentence_count}<br><br>
                        <strong>–¢–µ–∫—Å—Ç —Ä–µ–∑—é–º–µ:</strong><br>
                        ${data.summary.summary.summary}<br><br>
                        <strong>–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:</strong><br>
                        ${data.summary.summary.key_points.map(point => `‚Ä¢ ${point}`).join('<br>')}
                    </div>
                `;
                container.appendChild(summary);
            }
            
            // UX –∞–Ω–∞–ª–∏–∑
            if (data.ux_review && data.ux_review.success) {
                const uxReview = document.createElement('div');
                uxReview.className = 'result-section';
                uxReview.innerHTML = `
                    <h3>üé® UX –ê–Ω–∞–ª–∏–∑</h3>
                    <div class="result-content">
                        <strong>–û–±—â–∏–π –±–∞–ª–ª:</strong> ${data.ux_review.ux_review.overall_score}/10<br>
                        <strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–≤:</strong> ${data.ux_review.ux_review.word_count}<br><br>
                        <strong>–î–æ—Å—Ç–æ–∏–Ω—Å—Ç–≤–∞:</strong><br>
                        ${data.ux_review.ux_review.strengths.map(strength => `‚Ä¢ ${strength}`).join('<br>')}<br><br>
                        <strong>–°–ª–∞–±—ã–µ –º–µ—Å—Ç–∞:</strong><br>
                        ${data.ux_review.ux_review.weaknesses.map(weakness => `‚Ä¢ ${weakness}`).join('<br>')}<br><br>
                        <strong>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:</strong><br>
                        ${data.ux_review.ux_review.recommendations.map(rec => 
                            `<strong>${rec.title}</strong> (${rec.priority})<br>${rec.description}<br><br>`
                        ).join('')}
                    </div>
                `;
                container.appendChild(uxReview);
            }
            
            // –î–∏–∑–∞–π–Ω —Å–æ–≤–µ—Ç—ã
            if (data.design_advice && data.design_advice.success) {
                const designAdvice = document.createElement('div');
                designAdvice.className = 'result-section';
                designAdvice.innerHTML = `
                    <h3>üé® –°–æ–≤–µ—Ç—ã –ø–æ –¥–∏–∑–∞–π–Ω—É</h3>
                    <div class="result-content">
                        <strong>–û–±—â–∏–π –±–∞–ª–ª –¥–∏–∑–∞–π–Ω–∞:</strong> ${data.design_advice.design_advice.overall_design_score}/10<br>
                        <strong>–≠—Ç–æ –ª–µ–Ω–¥–∏–Ω–≥:</strong> ${data.design_advice.design_advice.is_landing_page ? '–î–∞' : '–ù–µ—Ç'}<br><br>
                        <strong>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:</strong><br>
                        ${data.design_advice.design_advice.recommendations.map(rec => 
                            `<strong>${rec.title}</strong> (${rec.priority}, ${rec.implementation_difficulty})<br>
                            <em>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</em> ${rec.category}<br>
                            ${rec.description}<br><br>`
                        ).join('')}
                    </div>
                `;
                container.appendChild(designAdvice);
            }
            
            // –°—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ (–µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω JSON —Ñ–æ—Ä–º–∞—Ç)
            if (document.getElementById('outputFormat').value === 'json') {
                const rawData = document.createElement('div');
                rawData.className = 'result-section';
                rawData.innerHTML = `
                    <h3>üîß –°—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ (JSON)</h3>
                    <div class="result-content">
                        <pre>${JSON.stringify(data, null, 2)}</pre>
                    </div>
                `;
                container.appendChild(rawData);
            }
            
            showResults();
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º
        function showProgress() {
            document.getElementById('progressContainer').style.display = 'block';
            document.getElementById('analyzeBtn').disabled = true;
            document.getElementById('analyzeBtn').textContent = '‚è≥ –ê–Ω–∞–ª–∏–∑ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è...';
        }

        function hideProgress() {
            setTimeout(() => {
                document.getElementById('progressContainer').style.display = 'none';
                document.getElementById('analyzeBtn').disabled = false;
                document.getElementById('analyzeBtn').textContent = 'üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–Ω–∞–ª–∏–∑';
            }, 1000);
        }

        function updateProgress(percent, text) {
            document.getElementById('progressFill').style.width = percent + '%';
            document.getElementById('progressText').textContent = text;
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
        function showResults() {
            document.getElementById('resultsContainer').style.display = 'block';
            document.getElementById('emptyState').style.display = 'none';
        }

        function hideResults() {
            document.getElementById('resultsContainer').style.display = 'none';
            document.getElementById('emptyState').style.display = 'block';
        }

        // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function showError(message) {
            const container = document.getElementById('resultsContent');
            container.innerHTML = `<div class="error-message">‚ùå ${message}</div>`;
            showResults();
        }

        function showSuccess(message) {
            const container = document.getElementById('resultsContent');
            const successDiv = document.createElement('div');
            successDiv.className = 'success-message';
            successDiv.innerHTML = `‚úÖ ${message}`;
            container.insertBefore(successDiv, container.firstChild);
        }

        // –ò—Å—Ç–æ—Ä–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
        function addToHistory(request) {
            requestHistory.unshift(request);
            if (requestHistory.length > 20) {
                requestHistory = requestHistory.slice(0, 20);
            }
            localStorage.setItem('analysisHistory', JSON.stringify(requestHistory));
            loadHistory();
        }

        function loadHistory() {
            const container = document.getElementById('historyContainer');
            container.innerHTML = '';
            
            if (requestHistory.length === 0) {
                container.innerHTML = '<p style="color: #6c757d; text-align: center; padding: 20px;">–ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞</p>';
                return;
            }
            
            requestHistory.forEach(request => {
                const item = document.createElement('div');
                item.className = 'history-item';
                item.onclick = () => loadFromHistory(request);
                
                const statusClass = request.status === 'success' ? 'status-success' : 
                                  request.status === 'error' ? 'status-error' : 'status-loading';
                
                item.innerHTML = `
                    <div class="history-url">
                        <span class="status-indicator ${statusClass}"></span>
                        ${request.url}
                    </div>
                    <div class="history-time">
                        ${new Date(request.timestamp).toLocaleString()}
                        ${request.duration ? ` ‚Ä¢ ${request.duration}ms` : ''}
                    </div>
                `;
                container.appendChild(item);
            });
        }

        function loadFromHistory(request) {
            document.getElementById('url').value = request.url;
            // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –¥—Ä—É–≥–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏
        }

        function clearHistory() {
            if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é –∑–∞–ø—Ä–æ—Å–æ–≤?')) {
                requestHistory = [];
                localStorage.removeItem('analysisHistory');
                loadHistory();
            }
        }
    </script>
</body>
</html>
